<!DOCTYPE html>
<!--[if lt IE 7]>       <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>          <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>          <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <title>Input Validation - React-MVx</title>
    <meta name="description" content="MVVM Architecture Framework for React" />
    <meta name="author" content="Vlad Balin">
    <meta charset="UTF-8">
    <link rel="icon" href="../themes/daux/img/favicon-navy.png" type="image/x-icon">
    <!-- Mobile -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Font -->
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700&subset=latin,cyrillic-ext,cyrillic' rel='stylesheet' type='text/css'>
    <!-- CSS -->
    <link href='../themes/daux/css/theme-navy.min.css' rel='stylesheet' type='text/css'>
            <!-- Tipue Search -->
        <link href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body class="">
    
<header class="Navbar hidden-print">
    <a class="Navbar__brand" href="../index.html">React-MVx</a>

    <div class="Search">
        <svg class="Search__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 451 451"><path d="M447.05 428l-109.6-109.6c29.4-33.8 47.2-77.9 47.2-126.1C384.65 86.2 298.35 0 192.35 0 86.25 0 .05 86.3.05 192.3s86.3 192.3 192.3 192.3c48.2 0 92.3-17.8 126.1-47.2L428.05 447c2.6 2.6 6.1 4 9.5 4s6.9-1.3 9.5-4c5.2-5.2 5.2-13.8 0-19zM26.95 192.3c0-91.2 74.2-165.3 165.3-165.3 91.2 0 165.3 74.2 165.3 165.3s-74.1 165.4-165.3 165.4c-91.1 0-165.3-74.2-165.3-165.4z"/></svg>
        <input type="search" id="tipue_search_input" class="Search__field" placeholder="Search..." autocomplete="on" results=25 autosave=text_search>
    </div>
</header>
<div class="Columns content">
    <aside class="Columns__left Collapsible">
        <div class="Collapsible__container">
            <button type="button" class="Button Collapsible__trigger">
                <span class="Collapsible__trigger--bar"></span>
                <span class="Collapsible__trigger--bar"></span>
                <span class="Collapsible__trigger--bar"></span>
            </button>
        </div>

        <div class="Collapsible__content">
            <!-- Navigation -->
            <ul class='Nav'><li class='Nav__item '><a href="../Getting_Started.html">Getting Started</a></li><li class='Nav__item Nav__item--open has-children'><a href="../Guides/Data_binding_and_forms.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Guides</a><ul class='Nav'><li class='Nav__item '><a href="../Guides/Data_binding_and_forms.html">Data binding and forms</a></li><li class='Nav__item Nav__item--active'><a href="../Guides/Input_Validation.html">Input Validation</a></li><li class='Nav__item '><a href="../Guides/Editable_Lists.html">Editable Lists</a></li><li class='Nav__item '><a href="../Guides/Paging.html">Paging</a></li><li class='Nav__item '><a href="../Guides/id-references_and_stores.html">id-references and stores</a></li><li class='Nav__item '><a href="../Guides/Layered_application_state.html">Layered application state</a></li></ul></li><li class='Nav__item '><a href="../Overview.html">Overview</a></li><li class='Nav__item  has-children'><a href="../Component/Overview.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Component</a><ul class='Nav'><li class='Nav__item '><a href="../Component/Overview.html">Overview</a></li><li class='Nav__item '><a href="../Component/props.html">props</a></li><li class='Nav__item '><a href="../Component/state.html">state</a></li><li class='Nav__item '><a href="../Component/store.html">store</a></li><li class='Nav__item '><a href="../Component/context.html">context</a></li><li class='Nav__item '><a href="../Component/Other_members.html">Other members</a></li></ul></li><li class='Nav__item  has-children'><a href="../Link/Overview.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Link</a><ul class='Nav'><li class='Nav__item '><a href="../Link/Overview.html">Overview</a></li><li class='Nav__item '><a href="../Link/Link_structure.html">Link structure</a></li><li class='Nav__item '><a href="../Link/Create_the_link.html">Create the link</a></li><li class='Nav__item '><a href="../Link/Link_transformations.html">Link transformations</a></li><li class='Nav__item '><a href="../Link/Links_to_objects_and_arrays.html">Links to objects and arrays</a></li></ul></li><li class='Nav__item '><a href="../Data-bound_controls.html">Data-bound controls</a></li><li class='Nav__item '><a href="../Examples.html">Examples</a></li></ul>

            <div class="Links">
                                    <hr/>
                                            <a href="https://github.com/Volicon/React-MVx/issues" target="_blank">Help/Support/Bugs</a>
                        <br />
                                            <a href="http://volicon.com" target="_blank">Made by Volicon (a Verizon company)</a>
                        <br />
                                    
                                    <div class="CodeToggler">
                        <hr/>
                                                    <a class="CodeToggler__button CodeToggler__button--main" href="#">Show Code Blocks Inline</a><br>
                                            </div>
                
                                    <hr/>
                    <div class="Twitter">
                                                    <iframe allowtransparency="true" frameborder="0" scrolling="no" style="width:162px; height:20px;" src="https://platform.twitter.com/widgets/follow_button.html?screen_name=gaperton&amp;show_count=false"></iframe>
                            <br />
                            <br />
                                            </div>
                            </div>
        </div>
    </aside>
    <div class="Columns__right ">
        <div class="Columns__right__content">
            <div class="doc_content">
                <article class="Page">

    <div class="Page__header">
        <h1>Input Validation</h1>
                <span style="float: left; font-size: 10px; color: gray;">
            Wednesday, May 31, 2017 12:53 PM        </span>
                        <span style="float: right; font-size: 10px; color: gray;">
            <a href="https://github.com/Volicon/React-MVx/blob/develop/docs/01_Guides/02_Input_Validation.md" target="_blank">Edit on GitHub</a>
        </span>
            </div>


    <div class="s-content">
        <p>In this tutorial we will add input validation to the user editing form from the <a href="Data_binding_and_forms.html">previous example</a>. That's the client-side &quot;as-you-type&quot; validation preventing the user from submitting invalid data while giving him hints.</p>
<p><img src="validation.png" alt="Validated form" /></p>
<h1 id="page_State+definition+and+validation+checks">State definition and validation checks</h1>
<p>All state attributes in React-MVx has associated run-time types and the metadata. The general form of an attribute definition is <code>Constructor.value( defaultValue )</code>. When the <code>defaultValue</code> is used as an attribute definition (as it was in <a href="Data_binding_and_forms.html">previous example</a>), its type (Constructor) is taken from the value.</p>
<p><code>.value( defaultValue )</code> can be omitted as well. If an attribute definition is the function, it assumed to be the attribute's <code>Constructor</code>. Therefore, the following state definition is equivalent to one in the example.</p>
<pre><code class="language-javascript">@define class Application extends React.Component {
    static state = {
        name : String, // same as ''
        email : String, // same as ''
        isActive : Boolean.value( true ) // same as true
    };
    ...
}
</code></pre>
<p>This is important because validation checks are the part of the attribute definition. Which is cool, as it allows us to make custom attribute types with all of the validation checks encapsulated. Lets do this for the email.</p>
<p>Validator itself is the function taking the attribute's value and returning <code>true</code> whenever it is valid.</p>
<pre><code class="language-javascript">// Something simple, just for illustration purposes.
function isValidEmail( x ){
    return !x || x.indexOf('@') &gt;= 0;
}

// That would be the validation error message.
isValidEmail.error = 'Invalid email';
</code></pre>
<p>Then, we need to attach the validator to the attribute definition. And we've got the Email attribute type which can be used anywhere across the system.</p>
<pre><code class="language-javascript">const Email = String.has.check( isValidEmail );
</code></pre>
<p>Now we have all we need to define our state. We will use the built-in validation check <code>isRequired</code> which fails at empty values for the state of required form elements. This check is special because it is always executed first.</p>
<pre><code class="language-javascript">@define class Application extends React.Component {
    static state = {
        name : String.isRequired,
        email : Email.isRequired,
        isActive : true
    };
    ...
}
</code></pre>
<h1 id="page_Displaying+validation+errors">Displaying validation errors</h1>
<p>In React-MVx, the validation happens transparently and automatically. When you create the link, the attribute's validation error is accessible as <code>link.error</code>. Nothing special needs to be done to <em>trigger</em> the validation, all you have to do is to display the error.</p>
<pre><code class="language-javascript">    render(){
        const { name, email, isActive } = this.linkAll();
        return (
            &lt;form onSubmit={ this.onSubmit }&gt;
                &lt;label&gt; Name: 
                    &lt;div className=&quot;validated-control&quot;&gt;
                        &lt;input type=&quot;text&quot; { ...link.props} /&gt;
                        { link.error &amp;&amp; &lt;div className=&quot;error&quot;&gt;{ link.error }&lt;/div&gt; }
                    &lt;/div&gt;
                &lt;/label&gt;
                ...
            &lt;/form&gt;
        );
    }
</code></pre>
<p>And we would like to have the Save button disabled in case if the state is not valid for any reason:</p>
<pre><code class="language-javascript">...
&lt;button type=&quot;submit&quot; disabled={!this.state.isValid()}&gt;
    Save
&lt;/button&gt;
...
</code></pre>
<p>That's it. There's one more optional but important thing left to do, though.</p>
<h1 id="page_Linked+UI+controls">Linked UI controls</h1>
<p>The final touch is to wrap the form's input displaying the validation error to the dedicated control, taking the <code>link</code> as an argument.</p>
<p>We define our own reusable <code>Input</code> form element which displays the validation error in the way we want:</p>
<pre><code class="language-javascript">const Input = ({ link, ...props }) =&gt; (
    &lt;div className=&quot;validated-control&quot;&gt;
        &lt;input {...props} {...link.props} /&gt;
        { link.error &amp;&amp; &lt;div className=&quot;error&quot;&gt;{ link.error }&lt;/div&gt; }
    &lt;/div&gt;
);
</code></pre>
<p>With that change, our <code>render()</code> method starts looking like this:</p>
<pre><code class="language-javascript">render(){
    // Link the state...
    const { name, email, isActive } = this.linkAll();
    return (
        &lt;form onSubmit={ this.onSubmit }&gt;
            &lt;label&gt;
                Name: &lt;Input type=&quot;text&quot; link={name}/&gt;
            &lt;/label&gt;
            &lt;label&gt;
                Email: &lt;Input type=&quot;text&quot; link={email}/&gt;
            &lt;/label&gt;
            &lt;label&gt;
                Is active: &lt;input type=&quot;checkbox&quot; {...isActive.props}/&gt;
            &lt;/label&gt;
            &lt;button type=&quot;submit&quot; disabled={!this.state.isValid()}&gt;
                Save
            &lt;/button&gt;
            &lt;button type=&quot;button&quot; onClick={this.onCancel}&gt;
                Clear
            &lt;/button&gt;
        &lt;/form&gt;
    );
}
</code></pre>
<p>As you can see, the validation does not affect the markup in React-MVx. Thanks to the <em>links</em>, which conveniently transport the validation error from the place where it occurs to the place where it's consumed.</p>
<h1 id="page_API+used+in+the+example">API used in the example</h1>
<h2 id="page_Record%27s++attribute+definitions">Record's <a href="https://volicon.github.io/Type-R/Record/Overview.html" class="external">attribute definitions</a></h2>
<h3 id="page_name+%3A+Type.value%28+defaultValue+%29"><code>attrDef</code> name : Type.value( defaultValue )</h3>
<p>The general form of type annotation is <code>Type.value( defaultValue )</code>, where the <code>Type</code> is the corresponding constructor function.</p>
<h3 id="page_name+%3A+Type"><code>attrDef</code> name : Type</h3>
<p>When the function is used as <code>attrDef</code>, it's treated as the constructor function.
Any constructor function may be used as an attribute type, if it behaves as <em>converting constructor</em> (like <code>new Date( msecs )</code>).</p>
<h3 id="page_name+%3A+defaultValue"><code>attrDef</code> name : defaultValue</h3>
<p>When other value than function is passed, it's treated as the default value and the type is being inferred form the value.
If you need to pass function as the default value, use <code>Function.value( theFunction )</code>.</p>
<h2 id="page_Validation"><a href="https://volicon.github.io/Type-R/API_by_feature/Validation.html" class="external">Validation</a></h2>
<h3 id="page_attr+%3A+Type.has.check%28+predicate%2C+errorMsg%3F+%29"><code>attrDef</code> attr : Type.has.check( predicate, errorMsg? )</h3>
<p>Attribute-level validator.</p>
<ul>
<li>
<code>predicate : value =&gt; boolean</code> is the function taking attribute's value and returning <code>true</code> whenever the value is valid.</li>
<li>optional <code>errorMsg</code> is the error message which will be passed in case if the validation fail.</li>
</ul>
<p>If <code>errorMsg</code> is omitted, error message will be taken from <code>predicate.error</code>. It makes possible to define reusable validation functions.</p>
<h3 id="page_attr+%3A+Type.isRequired"><code>attrDef</code> attr : Type.isRequired</h3>
<p>The special case of attribute-level check cutting out empty values. Attribute value must be truthy to pass, <code>&quot;Required&quot;</code> is used as validation error.</p>
<p><code>isRequired</code> is the first validator to check, no matter in which order validators were attached.</p>
<h3 id="page_recordOrCollection.isValid%28%29">recordOrCollection.isValid()</h3>
<p>Returns <code>true</code> whenever an object and its aggregation tree is valid.</p>
    </div>

        <nav>
        <ul class="Pager">
            <li class=Pager--prev><a href="../Guides/Data_binding_and_forms.html">Previous</a></li>            <li class=Pager--next><a href="../Guides/Editable_Lists.html">Next</a></li>        </ul>
    </nav>
    </article>

            </div>
        </div>
    </div>
</div>

    
    <!-- jQuery -->
    <script src="../themes/daux/js/jquery-1.11.3.min.js"></script>

    <!-- hightlight.js -->
    <script src="../themes/daux/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- JS -->
    
    <script src="../themes/daux/js/daux.js"></script>

            <!-- Tipue Search -->
        <script type="text/javascript" src="../tipuesearch/tipuesearch.js"></script>

        <script>
            window.onunload = function(){}; // force $(document).ready to be called on back/forward navigation in firefox
            $(function() {
                tipuesearch({
                    'base_url': '../'
                });
            });
        </script>
    
</body>
</html>
